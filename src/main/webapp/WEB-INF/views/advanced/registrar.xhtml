<ui:composition template="/WEB-INF/layout/layout.xhtml" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:tag="http://tags.cdi.training.gepardec.com"
>

    <!--@elvariable id="successEvents" type="java.util.List"-->
    <!--@elvariable id="failedEvents" type="java.util.List"-->

    <ui:define name="title">
        Registrar
    </ui:define>

    <ui:define name="body">
        <div class="container-lg">
            <div class="row my-2">
                <div class="col">
                    <div class="text-center">
                        <h1>Registrar (Pattern)</h1>
                    </div>
                </div>

                <hr class="my-3" />
            </div>

            <div class="row my-2">
                <div class="col">
                    <p>
                        Sometime it is necessary to capture the result of asynchronous invocations which are not
                        supposed to block the request and don't provide any useful information for the users but the
                        application needs to know the result of the invocation.
                    </p>
                    <p>
                        A use-case would be the asynchronous publishing of a page access or action invocation which
                        don't concern the users, but the application is supposed to log the results for monitoring
                        purposes.
                    </p>

                    <div class="text-center m-2">
                        <h:graphicImage url="/resources/img/advanced/registrar/use-case.svg" height="300px"
                            width="100%" alt="Registrar" />
                    </div>

                    <p>
                        See the package <code>at.gepardec.training.cdi.advanced.registrar.*</code> for the relevant
                        classes.
                        Especially take a look at the comments.
                    </p>

                    <hr class="my-3" />

                    <div class="d-flex justify-content-center flex-row my-2">
                        <div class="ms-2 d-flex align-items-center">
                            <tag:button id="refresh" text="Refresh" path="/advanced/registrar" />
                        </div>
                        <div class="ms-2 d-flex align-items-center">
                            <tag:button id="fireSuccessEvent" text="Success Event" path="/advanced/registrar/fire/successEvent" />
                        </div>
                        <div class="ms-2 d-flex align-items-center">
                            <tag:button id="fireFailEvent" text="Fail Event" path="/advanced/registrar/fire/failedEvent" />
                        </div>
                        <div class="ms-2 d-flex align-items-center">
                            <tag:button id="clear" text="Clear" path="/advanced/registrar/clear" />
                        </div>
                    </div>

                    <hr class="my-3" />
                </div>
            </div>

            <div class="row my-2">
                <div class="col">
                    <div class="row m-1">
                        <div class="col-sm text-center text-sm-right mr-sm-1">
                            Success Events
                        </div>
                        <div class="col-sm text-center text-sm-left ml-sm-1">
                            <ui:repeat value="#{successEvents}" var="event">
                                <h:outputText value="#{event}" styleClass="font-weight-bold" />
                                <br />
                            </ui:repeat>
                        </div>
                    </div>

                    <hr class="my-3" />

                    <div class="row m-1">
                        <div class="col-sm text-center text-sm-right mr-sm-1">
                            Failed Events
                        </div>
                        <div class="col-sm text-center text-sm-left ml-sm-1">
                            <ui:repeat value="#{failedEvents}" var="event">
                                <h:outputText value="#{event}" styleClass="font-weight-bold" />
                                <br />
                            </ui:repeat>
                        </div>
                    </div>

                    <hr class="my-3" />

                    <div class="text-center font-weight-bold">
                        <p>
                            This problem can solved by providing a registrar CDI Bean in the application or session
                            scope. The futures or asynchronous results are registered on the registrar which can be
                            accessed by other parts of the application.
                        </p>
                    </div>

                    <hr class="my-3" />
                </div>
            </div>
        </div>
    </ui:define>
</ui:composition>